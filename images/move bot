# –∏–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫
from telegram import Update, ReplyKeyboardMarkup, KeyboardButton
from telegram.ext import Application, CommandHandler, MessageHandler, filters, ConversationHandler, ContextTypes
from apscheduler.schedulers.background import BackgroundScheduler
from datetime import datetime, timedelta
import asyncio
import pandas as pd
from io import BytesIO

LANGUAGE, NAME, PHONE, MAIN_MENU, DIRECTION, SLOT_SELECT, STYLE_INFO, CANCEL_BOOKING = range(8)
user_bookings = {}
user_languages = {}

ADMINS = [664012195, 123456789]

languages = ["–†—É—Å—Å–∫–∏–π üá∑üá∫", "English üá¨üáß", "ƒåe≈°tina üá®üáø"]

# –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ–≤–∞—Ä–∏
texts = {
    "–†—É—Å—Å–∫–∏–π üá∑üá∫": {
        "choose_lang": "üëã –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏ —è–∑—ã–∫:",
        "enter_name": "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Å–≤–æ—ë –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é.",
        "send_phone": "–û—Ç–ø—Ä–∞–≤—å, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–≤–æ–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞:",
        "send_contact": "üì± –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–º–µ—Ä",
        "main_menu": "–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å —Ç—ã –º–æ–∂–µ—à—å –≤—ã–±—Ä–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ:",
        "choose_style": "–í—ã–±–µ—Ä–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:",
        "choose_time": "–í—ã–±–µ—Ä–∏ –≤—Ä–µ–º—è:",
        "booked": "–¢—ã –∑–∞–ø–∏—Å–∞–Ω –Ω–∞",
        "your_bookings": "–¢–≤–æ–∏ –∑–∞–ø–∏—Å–∏ –Ω–∞ –±–ª–∏–∂–∞–π—à—É—é –Ω–µ–¥–µ–ª—é:",
        "no_bookings": "–£ —Ç–µ–±—è –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π.",
        "choose_info": "–í—ã–±–µ—Ä–∏ —Å—Ç–∏–ª—å, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏:",
        "back": "üîô –ù–∞–∑–∞–¥",
        "home": "üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é",
        "cancel_prompt": "–í—ã–±–µ—Ä–∏ –∑–∞–ø–∏—Å—å, –∫–æ—Ç–æ—Ä—É—é —Ö–æ—á–µ—à—å –æ—Ç–º–µ–Ω–∏—Ç—å:",
        "cancel_success": "–ó–∞–ø–∏—Å—å –æ—Ç–º–µ–Ω–µ–Ω–∞.",
        "cancel_none": "–£ —Ç–µ–±—è –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –¥–ª—è –æ—Ç–º–µ–Ω—ã.",
        "cancel_button": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å",
        "main_buttons": [["üìÖ –ó–∞–ø–∏—Å–∞—Ç—å—Å—è", "üìã –ú–æ–∏ –∑–∞–ø–∏—Å–∏"], ["üìñ –î–µ—Ç–∞–ª–∏ –æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏", "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å"]],
        "remind_weekend": "üóì –ù–µ –∑–∞–±—É–¥—å –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –Ω–µ–¥–µ–ª—é!",
        "remind_daybefore": "‚ùóÔ∏è–ù–∞–ø–æ–º–∏–Ω–∞–µ–º: –∑–∞–≤—Ç—Ä–∞ —É —Ç–µ–±—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞. –ï—Å–ª–∏ –Ω–µ –æ—Ç–º–µ–Ω–∏—à—å –∏ –Ω–µ –ø—Ä–∏–¥–µ—à—å ‚Äî –∑–∞–ø–∏—Å—å —Å–≥–æ—Ä–∏—Ç!"
    },
    "English üá¨üáß": {
        "choose_lang": "üëã Please choose a language:",
        "enter_name": "Please enter your first and last name.",
        "send_phone": "Please send your phone number:",
        "send_contact": "üì± Send phone number",
        "main_menu": "Great! Now you can choose what to do:",
        "choose_style": "Choose a style:",
        "choose_time": "Choose a time slot:",
        "booked": "You are booked for",
        "your_bookings": "Your bookings for the upcoming week:",
        "no_bookings": "You have no bookings yet.",
        "choose_info": "Choose a style to see details:",
        "back": "üîô Back",
        "home": "üè† Main Menu",
        "cancel_prompt": "Select a booking to cancel:",
        "cancel_success": "Booking cancelled.",
        "cancel_none": "You have no bookings to cancel.",
        "cancel_button": "‚ùå Cancel a booking",
        "main_buttons": [["üìÖ Book a class", "üìã My bookings"], ["üìñ About styles", "‚ùå Cancel a booking"]],
        "remind_weekend": "üóì Don't forget to book your dance classes for next week!",
        "remind_daybefore": "‚ùóÔ∏èReminder: you have class tomorrow. If you don't cancel and don't show up, it will be lost!"
    },
    "ƒåe≈°tina üá®üáø": {
        "choose_lang": "üëã Pros√≠m, vyber si jazyk:",
        "enter_name": "Zadej sv√© jm√©no a p≈ô√≠jmen√≠.",
        "send_phone": "Po≈°li pros√≠m sv√© telefonn√≠ ƒç√≠slo:",
        "send_contact": "üì± Poslat ƒç√≠slo",
        "main_menu": "Skvƒõl√©! Teƒè si m≈Ø≈æe≈° vybrat, co chce≈° udƒõlat:",
        "choose_style": "Vyber smƒõr:",
        "choose_time": "Vyber si ƒças:",
        "booked": "Jsi zapsan√Ω na",
        "your_bookings": "Tv√© rezervace na p≈ô√≠≈°t√≠ t√Ωden:",
        "no_bookings": "Zat√≠m nem√°≈° ≈æ√°dn√© rezervace.",
        "choose_info": "Vyber styl a zjisti v√≠c:",
        "back": "üîô Zpƒõt",
        "home": "üè† Hlavn√≠ menu",
        "cancel_prompt": "Vyber rezervaci ke zru≈°en√≠:",
        "cancel_success": "Rezervace byla zru≈°ena.",
        "cancel_none": "Nem√°≈° ≈æ√°dn√© rezervace ke zru≈°en√≠.",
        "cancel_button": "‚ùå Zru≈°it rezervaci",
        "main_buttons": [["üìÖ Rezervovat", "üìã Moje rezervace"], ["üìñ Info o stylech", "‚ùå Zru≈°it rezervaci"]],
        "remind_weekend": "üóì Nezapome≈à si rezervovat tr√©ninky na dal≈°√≠ t√Ωden!",
        "remind_daybefore": "‚ùóÔ∏èP≈ôipom√≠nka: z√≠tra m√°≈° tr√©nink. Pokud nezru≈°√≠≈° a nep≈ôijde≈°, rezervace propadne!"
    }
}

localized_days = {
    "–†—É—Å—Å–∫–∏–π üá∑üá∫": ["–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", "–í—Ç–æ—Ä–Ω–∏–∫", "–°—Ä–µ–¥–∞", "–ß–µ—Ç–≤–µ—Ä–≥", "–ü—è—Ç–Ω–∏—Ü–∞", "–°—É–±–±–æ—Ç–∞", "–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ"],
    "English üá¨üáß": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"],
    "ƒåe≈°tina üá®üáø": ["Pondƒõl√≠", "√öter√Ω", "St≈ôeda", "ƒåtvrtek", "P√°tek", "Sobota", "Nedƒõle"]
}
weekday_index = {
    "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫": 0, "–í—Ç–æ—Ä–Ω–∏–∫": 1, "–°—Ä–µ–¥–∞": 2, "–ß–µ—Ç–≤–µ—Ä–≥": 3,
    "–ü—è—Ç–Ω–∏—Ü–∞": 4, "–°—É–±–±–æ—Ç–∞": 5, "–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ": 6,
    "Monday": 0, "Tuesday": 1, "Wednesday": 2, "Thursday": 3,
    "Friday": 4, "Saturday": 5, "Sunday": 6,
    "Pondƒõl√≠": 0, "√öter√Ω": 1, "St≈ôeda": 2, "ƒåtvrtek": 3,
    "P√°tek": 4, "Sobota": 5, "Nedƒõle": 6,
}
style_info = {
    "Girly Hip-Hop": {
        "–†—É—Å—Å–∫–∏–π üá∑üá∫": [
            "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/girly-hip-hop.jpeg?raw=true",
            "<b>–û —Å—Ç–∏–ª–µ:</b> –≠–Ω–µ—Ä–≥–∏—á–Ω—ã–π —Ç–∞–Ω–µ—Ü —Å –∂–µ–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∞–∫—Ü–µ–Ω—Ç–∞–º–∏, —Å–∏–ª—å–Ω–æ–π –ø–æ–¥–∞—á–µ–π –∏ —É–ª–∏—á–Ω—ã–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º. –ü–æ–º–æ–≥–∞–µ—Ç —Ä–∞—Å–∫—Ä—ã—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ —Ö–∞—Ä–∏–∑–º—É.\n<b>–î–ª—è –∫–æ–≥–æ:</b> –î–ª—è –¥–µ–≤—É—à–µ–∫, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç —Ç–∞–Ω—Ü–µ–≤–∞—Ç—å —è—Ä–∫–æ, —Å–≤–æ–±–æ–¥–Ω–æ –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —É—Ä–æ–≤–Ω—è.\n<b>–ß—Ç–æ –≤–∑—è—Ç—å:</b> –£–¥–æ–±–Ω—ã–µ –∫—Ä–æ—Å—Å–æ–≤–∫–∏, —Å–≤–æ–±–æ–¥–Ω—ã–µ —à—Ç–∞–Ω—ã –∏–ª–∏ —Ç–æ –≤ —á—ë–º –±—É–¥–µ—Ç —É–¥–æ–±–Ω–æ –¥–≤–∏–≥–∞—Ç—å—Å—è, —Ç–æ–ø/ —Ñ—É—Ç–±–æ–ª–∫–∞, –ø–æ –∂–µ–ª–∞–Ω–∏—é ‚Äî –æ–≤–µ—Ä—Å–∞–π–∑ —Ö—É–¥–∏."
        ],
        "English üá¨üáß": [
            "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/girly-hip-hop.jpeg?raw=true",
            "<b>Style:</b> Energetic dance with feminine accents and street character. Helps boost confidence and charisma.\n<b>For whom:</b> Girls who want to dance brightly, freely, and confidently at any level.\n<b>What to bring:</b> Comfortable sneakers, loose pants or any comfortable clothes, top or T-shirt, optionally an oversized hoodie."
        ],
        "ƒåe≈°tina üá®üáø": [
            "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/girly-hip-hop.jpeg?raw=true",
            "<b>Styl:</b> Energick√Ω tanec se ≈æensk√Ωmi prvky a pouliƒçn√≠m charakterem. Pom√°h√° rozv√≠jet sebevƒõdom√≠ a charisma.\n<b>Pro koho:</b> Pro d√≠vky, kter√© chtƒõj√≠ tanƒçit v√Ωraznƒõ, svobodnƒõ a sebejistƒõ, bez ohledu na √∫rove≈à.\n<b>Co si vz√≠t:</b> Pohodln√© tenisky, voln√© kalhoty nebo cokoliv pohodln√©ho na pohyb, top nebo triƒçko, volitelnƒõ oversize mikinu."
        ]
    },
    "Jazz Funk": {
        "–†—É—Å—Å–∫–∏–π üá∑üá∫": [
            "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/jazz-funk.jpeg?raw=true",
            "<b>–û —Å—Ç–∏–ª–µ:</b> –í–∑—Ä—ã–≤–Ω–æ–π –º–∏–∫—Å –¥–≤–∏–∂–µ–Ω–∏–π. –Ø—Ä–∫–∏–π, —ç—Ñ—Ñ–µ–∫—Ç–Ω—ã–π —Å—Ç–∏–ª—å –∫–∞–∫ –≤ –∫–ª–∏–ø–∞—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∞—Ä—Ç–∏—Å—Ç–æ–≤.\n<b>–î–ª—è –∫–æ–≥–æ:</b> –ü–æ–¥–æ–π–¥–µ—Ç —Ç–µ–º, –∫—Ç–æ —Ö–æ—á–µ—Ç —Ç–∞–Ω—Ü–µ–≤–∞—Ç—å —Ä–∞—Å–∫–æ–≤–∞–Ω–Ω–æ, —è—Ä–∫–æ –∏ —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ–º.\n<b>–ß—Ç–æ –≤–∑—è—Ç—å:</b> –ö—Ä–æ—Å—Å–æ–≤–∫–∏, —Å–≤–æ–±–æ–¥–Ω—ã–µ —à—Ç–∞–Ω—ã, —Ç–æ–ø –∏–ª–∏ —Ñ—É—Ç–±–æ–ª–∫–∞."
        ],
        "English üá¨üáß": [
            "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/jazz-funk.jpeg?raw=true",
            "<b>Style:</b> Explosive mix of movements. Bright and flashy like in music videos.\n<b>For whom:</b> Perfect for those who want to dance freely and with flair.\n<b>What to bring:</b> Sneakers, loose pants, top or T-shirt."
        ],
        "ƒåe≈°tina üá®üáø": [
            "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/jazz-funk.jpeg?raw=true",
            "<b>Styl:</b> V√Ωbu≈°n√° kombinace pohyb≈Ø. V√Ωrazn√Ω styl jako z hudebn√≠ch videoklip≈Ø.\n<b>Pro koho:</b> Pro ty, kte≈ô√≠ chtƒõj√≠ tanƒçit uvolnƒõnƒõ, v√Ωraznƒõ a s n√°ladou.\n<b>Co si vz√≠t:</b> Tenisky, voln√© kalhoty, top nebo triƒçko."
        ]
    },

    "Choreo": {
    "–†—É—Å—Å–∫–∏–π üá∑üá∫": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/choreo.jpeg?raw=true",
        "<b>–û —Å—Ç–∏–ª–µ:</b> –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ —Ä–∞–º–∫–∏ —Å—Ç–∏–ª—è. –†–∞–∑–≤–∏—Ç–∏–µ –º—É–∑—ã–∫–∞–ª—å–Ω–æ—Å—Ç–∏, —Ä–∞–±–æ—Ç–∞ —Å —Ä–∏—Ç–º–æ–º –∏ —Å–≤–æ–±–æ–¥–æ–π –¥–≤–∏–∂–µ–Ω–∏–π.\n<b>–î–ª—è –∫–æ–≥–æ:</b> –î–ª—è –≤—Å–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ —Ç–∞–Ω—Ü–µ–≤–∞—Ç—å –∏ –±—ã—Å—Ç—Ä–æ –æ—Å–≤–∞–∏–≤–∞—Ç—å –Ω–æ–≤—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è.\n<b>–ß—Ç–æ –≤–∑—è—Ç—å:</b> –£–¥–æ–±–Ω—ã–µ –∫—Ä–æ—Å—Å–æ–≤–∫–∏, —Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ —à—Ç–∞–Ω—ã, —Ç–æ–ø/—Ñ—É—Ç–±–æ–ª–∫–∞."
    ],
    "English üá¨üáß": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/choreo.jpeg?raw=true",
        "<b>Style:</b> Goes beyond style boundaries. Focuses on musicality, rhythm and movement freedom.\n<b>For whom:</b> Anyone who wants to dance confidently and learn fast.\n<b>What to bring:</b> Comfortable sneakers, sports pants, top or T-shirt."
    ],
    "ƒåe≈°tina üá®üáø": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/choreo.jpeg?raw=true",
        "<b>Styl:</b> P≈ôesahuje bƒõ≈æn√© taneƒçn√≠ styly. Rozv√≠j√≠ muzikalitu, rytmus a svobodu pohybu.\n<b>Pro koho:</b> Pro ka≈æd√©ho, kdo chce tanƒçit sebejistƒõ a rychle se uƒçit nov√© pohyby.\n<b>Co si vz√≠t:</b> Pohodln√© tenisky, sportovn√≠ kalhoty, top nebo triƒçko."
    ]
},
"Contemporary": {
    "–†—É—Å—Å–∫–∏–π üá∑üá∫": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/contemporary.jpeg?raw=true",
        "<b>–û —Å—Ç–∏–ª–µ:</b> –ü–ª–∞—Å—Ç–∏—á–Ω—ã–π –∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å, —Å–æ–µ–¥–∏–Ω—è—é—â–∏–π —Ç–∞–Ω–µ—Ü, —Å–≤–æ–±–æ–¥—É –¥–≤–∏–∂–µ–Ω–∏–π –∏ —ç–º–æ—Ü–∏–π, —Ä–∞–±–æ—Ç—É —Å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º.\n<b>–î–ª—è –∫–æ–≥–æ:</b> –î–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å –≥–∏–±–∫–æ—Å—Ç—å, –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —ç–º–æ—Ü–∏—è–º–∏ —á–µ—Ä–µ–∑ —Ç–∞–Ω–µ—Ü.\n<b>–ß—Ç–æ –≤–∑—è—Ç—å:</b> –ù–æ—Å–æ—á–∫–∏, —É–¥–æ–±–Ω—É—é, –Ω–µ —Å–∫–æ–≤—ã–≤–∞—é—â—É—é –æ–¥–µ–∂–¥—É."
    ],
    "English üá¨üáß": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/contemporary.jpeg?raw=true",
        "<b>Style:</b> Fluid and emotional dance combining movement freedom and space awareness.\n<b>For whom:</b> For those who want to develop flexibility, expressiveness, and work with emotions through dance.\n<b>What to bring:</b> Socks and comfortable, non-restrictive clothing."
    ],
    "ƒåe≈°tina üá®üáø": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/contemporary.jpeg?raw=true",
        "<b>Styl:</b> Plynul√Ω a emotivn√≠ styl spojuj√≠c√≠ svobodu pohybu a pr√°ci s prostorem.\n<b>Pro koho:</b> Pro ty, kte≈ô√≠ chtƒõj√≠ rozv√≠jet flexibilitu, v√Ωraz a emoce skrze tanec.\n<b>Co si vz√≠t:</b> Pono≈æky a pohodln√©, voln√© obleƒçen√≠."
    ]
},
"High Heels": {
    "–†—É—Å—Å–∫–∏–π üá∑üá∫": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/hight-heels.jpeg?raw=true",
        "<b>–û —Å—Ç–∏–ª–µ:</b> –¢–∞–Ω—Ü—ã –Ω–∞ –∫–∞–±–ª—É–∫–∞—Ö, –∞–∫—Ü–µ–Ω—Ç –Ω–∞ –≥—Ä–∞—Ü–∏—é, –ø–ª–∞—Å—Ç–∏–∫—É –∏ —É–≤–µ—Ä–µ–Ω–Ω—É—é –ø–æ–¥–∞—á—É. –ü–æ–º–æ–≥–∞–µ—Ç —Ä–∞—Å–∫—Ä—ã—Ç—å –∂–µ–Ω—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∏ —É–ª—É—á—à–∏—Ç—å –ø–æ—Ö–æ–¥–∫—É.\n<b>–î–ª—è –∫–æ–≥–æ:</b> –î–ª—è –¥–µ–≤—É—à–µ–∫, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è —É–≤–µ—Ä–µ–Ω–Ω–æ –∏ –∫—Ä–∞—Å–∏–≤–æ –¥–≤–∏–≥–∞—Ç—å—Å—è –Ω–∞ –∫–∞–±–ª—É–∫–∞—Ö.\n<b>–ß—Ç–æ –≤–∑—è—Ç—å:</b> –£—Å—Ç–æ–π—á–∏–≤—ã–µ –∫–∞–±–ª—É–∫–∏ (–ª—É—á—à–µ –∑–∞–∫—Ä—ã—Ç—ã–µ, –Ω–∞ —Ä–µ–º–µ—à–∫–µ), —É–¥–æ–±–Ω–∞—è –æ–¥–µ–∂–¥–∞, –Ω–∞–∫–æ–ª–µ–Ω–Ω–∏–∫–∏."
    ],
    "English üá¨üáß": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/hight-heels.jpeg?raw=true",
        "<b>Style:</b> Dancing in heels with focus on grace, fluidity, and confidence.\n<b>For whom:</b> For girls who want to feel feminine and move confidently in heels.\n<b>What to bring:</b> Stable closed heels with straps, comfortable outfit, kneepads."
    ],
    "ƒåe≈°tina üá®üáø": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/hight-heels.jpeg?raw=true",
        "<b>Styl:</b> Tanec na podpatc√≠ch se zamƒõ≈ôen√≠m na ladnost, ≈æenskost a sebevƒõdom√≠.\n<b>Pro koho:</b> Pro d√≠vky, kter√© chtƒõj√≠ tanƒçit jistƒõ a kr√°snƒõ na podpatc√≠ch.\n<b>Co si vz√≠t:</b> Stabiln√≠ podpatky (ide√°lnƒõ zav≈ôen√© s p√°skem), pohodln√© obleƒçen√≠, chr√°niƒçe na kolena."
    ]
},

    "Frame Up": {
    "–†—É—Å—Å–∫–∏–π üá∑üá∫": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/frame-up.jpeg?raw=true",
        "<b>–û —Å—Ç–∏–ª–µ:</b> –ñ–µ–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π, –ø–ª–∞—Å—Ç–∏—á–Ω—ã–π —Å—Ç–∏–ª—å —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ —á—É–≤—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ–µ –≤–ª–∞–¥–µ–Ω–∏–µ —Ç–µ–ª–æ–º.\n<b>–î–ª—è –∫–æ–≥–æ:</b> –î–ª—è –¥–µ–≤—É—à–µ–∫, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç —Ä–∞—Å–∫—Ä–µ–ø–æ—Å—Ç–∏—Ç—å—Å—è, –ø–æ–¥—á–µ—Ä–∫–Ω—É—Ç—å –∂–µ–Ω—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∏ –Ω–∞—É—á–∏—Ç—å—Å—è —É–≤–µ—Ä–µ–Ω–Ω–æ –¥–≤–∏–≥–∞—Ç—å—Å—è.\n<b>–ß—Ç–æ –≤–∑—è—Ç—å:</b> –¢—É—Ñ–ª–∏ –∏–ª–∏ –Ω–æ—Å–∫–∏, —É–¥–æ–±–Ω–∞—è –æ–¥–µ–∂–¥–∞, –Ω–∞–∫–æ–ª–µ–Ω–Ω–∏–∫–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ."
    ],
    "English üá¨üáß": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/frame-up.jpeg?raw=true",
        "<b>Style:</b> Feminine and sensual with strong body control and expression.\n<b>For whom:</b> For girls who want to boost confidence, express femininity, and feel in control.\n<b>What to bring:</b> Shoes or socks, comfortable clothes, kneepads are a must."
    ],
    "ƒåe≈°tina üá®üáø": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/frame-up.jpeg?raw=true",
        "<b>Styl:</b> ≈Ωensk√Ω a smysln√Ω s d≈Ørazem na sebevƒõdom√Ω pohyb a kontrolu tƒõla.\n<b>Pro koho:</b> Pro d√≠vky, kter√© chtƒõj√≠ zv√Ω≈°it sv√© sebevƒõdom√≠ a nauƒçit se ovl√°dat sv√© tƒõlo.\n<b>Co si vz√≠t:</b> Boty nebo pono≈æky, pohodln√© obleƒçen√≠, chr√°niƒçe na kolena (povinn√©)."
    ]
},
"Mobility & Stretching": {
    "–†—É—Å—Å–∫–∏–π üá∑üá∫": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/mobility-and-stretching.jpeg?raw=true",
        "<b>–û —Å—Ç–∏–ª–µ:</b> –ó–∞–Ω—è—Ç–∏—è –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ –≥–∏–±–∫–æ—Å—Ç–∏, –ø–æ–¥–≤–∏–∂–Ω–æ—Å—Ç–∏ —Å—É—Å—Ç–∞–≤–æ–≤ –∏ —Å–Ω—è—Ç–∏–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è. –ú—è–≥–∫–∞—è –ø—Ä–æ—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ–≥–æ —Ç–µ–ª–∞.\n<b>–î–ª—è –∫–æ–≥–æ:</b> –ü–æ–¥—Ö–æ–¥–∏—Ç –≤—Å–µ–º —É—Ä–æ–≤–Ω—è–º. –û—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —Ö–æ—á–µ—à—å —É–ª—É—á—à–∏—Ç—å —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ, –æ—Å–∞–Ω–∫—É, –ø–æ–¥–≤–∏–∂–Ω–æ—Å—Ç—å –∏ —Ä–∞—Å—Ç—è–∂–∫—É.\n<b>–ß—Ç–æ –≤–∑—è—Ç—å:</b> –°–ø–æ—Ä—Ç–∏–≤–Ω–∞—è —Ñ–æ—Ä–º–∞, –Ω–æ—Å–∫–∏."
    ],
    "English üá¨üáß": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/mobility-and-stretching.jpeg?raw=true",
        "<b>Style:</b> Gentle training focused on flexibility, joint mobility, and releasing tension.\n<b>For whom:</b> Suitable for all levels, especially those who want better posture, well-being, and range of motion.\n<b>What to bring:</b> Sportswear, socks."
    ],
    "ƒåe≈°tina üá®üáø": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/mobility-and-stretching.jpeg?raw=true",
        "<b>Styl:</b> Jemn√© cviƒçen√≠ na flexibilitu, mobilitu kloub≈Ø a uvolnƒõn√≠ napƒõt√≠.\n<b>Pro koho:</b> Vhodn√© pro v≈°echny √∫rovnƒõ, zejm√©na pokud chce≈° zlep≈°it dr≈æen√≠ tƒõla a pohyblivost.\n<b>Co si vz√≠t:</b> Sportovn√≠ obleƒçen√≠, pono≈æky."
    ]
},
"Morning Flow": {
    "–†—É—Å—Å–∫–∏–π üá∑üá∫": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/morning-flow.jpeg?raw=true",
        "<b>–û —Å—Ç–∏–ª–µ:</b> –ú—è–≥–∫–∏–µ —É—Ç—Ä–µ–Ω–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è —Ç–µ–ª–∞, —Å–Ω—è—Ç–∏—è –∑–∞–∂–∏–º–æ–≤ –∏ –±–æ–¥—Ä–æ—Å—Ç–∏ –Ω–∞ –≤–µ—Å—å –¥–µ–Ω—å.\n<b>–î–ª—è –∫–æ–≥–æ:</b> –î–ª—è –ª—é–±–æ–≥–æ —É—Ä–æ–≤–Ω—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –¥–µ–Ω—å –≤ —Ö–æ—Ä–æ—à–µ–º —Ä–∏—Ç–º–µ.\n<b>–ß—Ç–æ –≤–∑—è—Ç—å:</b> –ö–æ–º—Ñ–æ—Ä—Ç–Ω–∞—è –æ–¥–µ–∂–¥–∞, –Ω–æ—Å–∫–∏."
    ],
    "English üá¨üáß": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/morning-flow.jpeg?raw=true",
        "<b>Style:</b> Gentle morning movement to wake up the body and energize your day.\n<b>For whom:</b> For any level, ideal to start your day with a smooth rhythm.\n<b>What to bring:</b> Comfortable clothes, socks."
    ],
    "ƒåe≈°tina üá®üáø": [
        "https://github.com/HinakIvan/my-flutter-fire-base/blob/master/images/morning-flow.jpeg?raw=true",
        "<b>Styl:</b> Jemn√© rann√≠ lekce pro probuzen√≠ tƒõla a z√≠sk√°n√≠ energie na cel√Ω den.\n<b>Pro koho:</b> Pro v≈°echny √∫rovnƒõ, ide√°ln√≠ pro pozitivn√≠ start dne.\n<b>Co si vz√≠t:</b> Pohodln√© obleƒçen√≠, pono≈æky."
    ]
}

    # –ü—Ä–∏–º–µ—Ä –∑–∞–≤–µ—Ä—à—ë–Ω ‚Äî –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–æ–±–∞–≤–ª—é –ø–æ —Ç–æ–π –∂–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—Ä–æ—Å–µ,
    # –µ—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –ø—Ä–æ–¥–æ–ª–∂—É –æ—Å—Ç–∞–ª—å–Ω—ã–µ 5 —Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ.
}

slot_options = {
    "Girly Hip-Hop": ["Monday 15:00", "Wednesday 15:00"],
    "Jazz Funk": ["Tuesday 18:00", "Thursday 17:00"],
    "Choreo": ["Friday 17:00"],
    "Contemporary": ["Wednesday 17:00"],
    "High Heels": ["Thursday 16:00"],
    "Frame Up": ["Friday 18:00"],
    "Mobility & Stretching": ["Tuesday 10:00"],
    "Morning Flow": ["Monday 09:00"]
}

def get_next_weekday_date(day_name, lang):
    index = weekday_index.get(day_name, 0)
    today = datetime.today()
    days_ahead = (index - today.weekday() + 7) % 7
    if days_ahead == 0:
        days_ahead = 7
    return (today + timedelta(days=days_ahead)).strftime("%d.%m")



# === HANDLERS ===

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    keyboard = ReplyKeyboardMarkup([languages], resize_keyboard=True)
    await update.message.reply_text("üëã Choose language / –í—ã–±–µ—Ä–∏ —è–∑—ã–∫:", reply_markup=keyboard)
    return LANGUAGE

async def choose_language(update: Update, context: ContextTypes.DEFAULT_TYPE):
    lang = update.message.text
    if lang not in texts:
        # –°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —è–∑—ã–∫–æ–º ‚Üí –≤–µ—Ä–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –≤—ã–±–æ—Ä—É
        keyboard = ReplyKeyboardMarkup([languages], resize_keyboard=True)
        await update.message.reply_text("‚ùóÔ∏è–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏ —è–∑—ã–∫ –∏–∑ —Å–ø–∏—Å–∫–∞:", reply_markup=keyboard)
        return LANGUAGE

    context.user_data["lang"] = lang
    user_languages[update.effective_user.id] = lang
    keyboard = ReplyKeyboardMarkup([[texts[lang]["back"]]], resize_keyboard=True)
    await update.message.reply_text(texts[lang]["enter_name"], reply_markup=keyboard)
    return NAME

async def get_name(update: Update, context: ContextTypes.DEFAULT_TYPE):
    lang = context.user_data["lang"]
    if update.message.text == texts[lang]["back"]:
        return await start(update, context)
    context.user_data["name"] = update.message.text
    button = KeyboardButton(texts[lang]["send_contact"], request_contact=True)
    keyboard = ReplyKeyboardMarkup([[button], [texts[lang]["back"]]], resize_keyboard=True)
    await update.message.reply_text(texts[lang]["send_phone"], reply_markup=keyboard)
    return PHONE

async def get_phone(update: Update, context: ContextTypes.DEFAULT_TYPE):
    lang = context.user_data["lang"]
    if update.message.text == texts[lang]["back"]:
        return await get_name(update, context)
    if update.message.contact:
        context.user_data["phone"] = update.message.contact.phone_number
    return await get_main_menu(update, context)

async def get_main_menu(update: Update, context: ContextTypes.DEFAULT_TYPE):
    lang = context.user_data["lang"]
    keyboard = ReplyKeyboardMarkup(texts[lang]["main_buttons"], resize_keyboard=True)
    await update.message.reply_text(texts[lang]["main_menu"], reply_markup=keyboard)
    return MAIN_MENU

async def reservation(update: Update, context: ContextTypes.DEFAULT_TYPE):
    lang = context.user_data["lang"]
    styles = list(slot_options.keys())
    keyboard = ReplyKeyboardMarkup([[s] for s in styles] + [[texts[lang]["home"]]], resize_keyboard=True)
    await update.message.reply_text(texts[lang]["choose_style"], reply_markup=keyboard)
    return DIRECTION

async def select_slot(update: Update, context: ContextTypes.DEFAULT_TYPE):
    lang = context.user_data["lang"]
    style = update.message.text
    context.user_data["selected_style"] = style
    slots = slot_options.get(style, [])
    buttons = []

    for slot in slots:
        day_en, time = slot.split()
        date = get_next_weekday_date(day_en, lang)

        day_index = weekday_index.get(day_en, 0)
        localized_day = localized_days[lang][day_index]

        buttons.append([f"{style} ‚Äì {localized_day} {time} ({date})"])

    buttons.append([texts[lang]["home"]])
    await update.message.reply_text(
        texts[lang]["choose_time"],
        reply_markup=ReplyKeyboardMarkup(buttons, resize_keyboard=True)
    )
    return SLOT_SELECT


async def confirm_booking(update: Update, context: ContextTypes.DEFAULT_TYPE):
    lang = context.user_data["lang"]
    booking = update.message.text
    user_id = update.message.from_user.id
    user_bookings.setdefault(user_id, []).append(booking)
    await update.message.reply_text(f"{texts[lang]['booked']} {booking}")
    return await get_main_menu(update, context)

async def show_bookings(update: Update, context: ContextTypes.DEFAULT_TYPE):
    lang = context.user_data["lang"]
    user_id = update.message.from_user.id
    bookings = user_bookings.get(user_id, [])
    if bookings:
        await update.message.reply_text(texts[lang]["your_bookings"] + "\n" + "\n".join(bookings))
    else:
        await update.message.reply_text(texts[lang]["no_bookings"])
    return MAIN_MENU

async def ask_for_direction(update: Update, context: ContextTypes.DEFAULT_TYPE):
    lang = context.user_data["lang"]
    styles = list(style_info.keys())
    keyboard = ReplyKeyboardMarkup([[s] for s in styles] + [[texts[lang]["home"]]], resize_keyboard=True)
    await update.message.reply_text(texts[lang]["choose_info"], reply_markup=keyboard)
    return STYLE_INFO

async def show_style_info(update: Update, context: ContextTypes.DEFAULT_TYPE):
    lang = context.user_data.get("lang", "–†—É—Å—Å–∫–∏–π üá∑üá∫")
    text = update.message.text

    if text == texts[lang]["home"]:
        keyboard = ReplyKeyboardMarkup(texts[lang]["main_buttons"], resize_keyboard=True)
        await update.message.reply_text(texts[lang]["main_menu"], reply_markup=keyboard)
        return MAIN_MENU

    if text in style_info and lang in style_info[text]:
        photo, desc = style_info[text][lang]
        await update.message.reply_photo(photo=photo, caption=desc, parse_mode="HTML")
    else:
        await update.message.reply_text("–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Å—Ç–∏–ª—é –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.")

    return STYLE_INFO

async def cancel_booking_prompt(update: Update, context: ContextTypes.DEFAULT_TYPE):
    lang = context.user_data["lang"]
    user_id = update.message.from_user.id
    bookings = user_bookings.get(user_id, [])
    if not bookings:
        await update.message.reply_text(texts[lang]["cancel_none"])
        return MAIN_MENU
    keyboard = ReplyKeyboardMarkup([[b] for b in bookings] + [[texts[lang]["home"]]], resize_keyboard=True)
    await update.message.reply_text(texts[lang]["cancel_prompt"], reply_markup=keyboard)
    return CANCEL_BOOKING

async def cancel_booking(update: Update, context: ContextTypes.DEFAULT_TYPE):
    lang = context.user_data["lang"]
    user_id = update.message.from_user.id
    booking = update.message.text
    if booking in user_bookings.get(user_id, []):
        user_bookings[user_id].remove(booking)
        await update.message.reply_text(texts[lang]["cancel_success"])
    return await get_main_menu(update, context)

# === REMINDERS ===

async def send_weekend_reminders(app: Application):
    for user_id in user_bookings:
        lang = user_languages.get(user_id, "–†—É—Å—Å–∫–∏–π üá∑üá∫")
        await app.bot.send_message(user_id, texts[lang]["remind_weekend"])

async def send_day_before_reminders(app: Application):
    tomorrow = datetime.today() + timedelta(days=1)
    date_str = tomorrow.strftime("%d.%m")
    for user_id, bookings in user_bookings.items():
        for booking in bookings:
            if date_str in booking:
                lang = user_languages.get(user_id, "–†—É—Å—Å–∫–∏–π üá∑üá∫")
                await app.bot.send_message(user_id, texts[lang]["remind_daybefore"])
                break

            


from telegram.ext import CommandHandler
from collections import Counter

async def admin_panel(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    if user_id not in ADMINS:
        await update.message.reply_text("–£ —Ç–µ–±—è –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏.")
        return

    total_users = len(user_bookings)
    all_bookings = [b for bookings in user_bookings.values() for b in bookings]
    style_counts = Counter(b.split(" ‚Äì ")[0] for b in all_bookings)

    stats = f"üìä <b>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</b>\n–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {total_users}\n"
    for style, count in style_counts.items():
        stats += f"{style}: {count} –∑–∞–ø–∏—Å–µ–π\n"

    keyboard = ReplyKeyboardMarkup(
    [["üì• –í—ã–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"], ["üìã –í—Å–µ –∑–∞–ø–∏—Å–∏ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º"], [texts["–†—É—Å—Å–∫–∏–π üá∑üá∫"]["home"]]],
    resize_keyboard=True
)
    await update.message.reply_text(stats, parse_mode="HTML", reply_markup=keyboard)
    return MAIN_MENU

import pandas as pd
from io import BytesIO

async def export_users(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    if user_id not in ADMINS:
        return

    rows = []
    for uid, data in context.application.chat_data.items():
        name = data.get("name", "")
        phone = data.get("phone", "")
        bookings = user_bookings.get(uid, [])
        for booking in bookings:
            rows.append({"User ID": uid, "Name": name, "Phone": phone, "Booking": booking})

    if not rows:
        await update.message.reply_text("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—ã–≥—Ä—É–∑–∫–∏.")
        return

    df = pd.DataFrame(rows)
    output = BytesIO()
    df.to_excel(output, index=False)
    output.seek(0)

    await update.message.reply_document(document=output, filename="users.xlsx")

async def show_bookings_by_style(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    if user_id not in ADMINS:
        return

    # –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ
    styles_data = {}
    for uid, bookings in user_bookings.items():
        chat_data = context.application.chat_data.get(uid, {})
        name = chat_data.get("name", "–ë–µ–∑ –∏–º–µ–Ω–∏")
        phone = chat_data.get("phone", "–ë–µ–∑ –Ω–æ–º–µ—Ä–∞")

        for booking in bookings:
            style = booking.split(" ‚Äì ")[0]
            entry = f"üë§ {name}\nüìû {phone}\nüïì {booking}"
            styles_data.setdefault(style, []).append(entry)

    # –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ –∫–∞–∂–¥–æ–º—É —Å—Ç–∏–ª—é
    if not styles_data:
        await update.message.reply_text("–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π.")
        return

    for style, people in styles_data.items():
        msg = f"<b>{style}</b>:\n\n" + "\n\n".join(people)
        await update.message.reply_text(msg, parse_mode="HTML")
   

               
             

# === START ===

app = Application.builder().token("7770514801:AAHuMKFNZ3ljTqs5qN9fcRE4UIAHPXyIbQY").build()


conv_handler = ConversationHandler(
    entry_points=[CommandHandler("start", start)],
    states={
       LANGUAGE: [MessageHandler(filters.TEXT & (~filters.COMMAND), choose_language)],
        NAME: [MessageHandler(filters.TEXT, get_name)],
        PHONE: [MessageHandler(filters.TEXT | filters.CONTACT, get_phone)],
        MAIN_MENU: [
            MessageHandler(filters.Regex("^üìÖ"), reservation),
            MessageHandler(filters.Regex("^üìã"), show_bookings),
            MessageHandler(filters.Regex("^üìñ"), ask_for_direction),
            MessageHandler(filters.Regex("^‚ùå"), cancel_booking_prompt),
        ],
        DIRECTION: [MessageHandler(filters.TEXT, select_slot)],
        SLOT_SELECT: [MessageHandler(filters.TEXT, confirm_booking)],
        STYLE_INFO: [MessageHandler(filters.TEXT, show_style_info)],
        CANCEL_BOOKING: [MessageHandler(filters.TEXT, cancel_booking)]
    },
    fallbacks=[]
)


app.add_handler(conv_handler)
app.add_handler(CommandHandler("admin", admin_panel))
app.add_handler(MessageHandler(filters.Regex("^üì•"), export_users))
app.add_handler(MessageHandler(filters.Regex("^üìã –í—Å–µ –∑–∞–ø–∏—Å–∏ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º$"), show_bookings_by_style))


scheduler = BackgroundScheduler()
scheduler.add_job(lambda: asyncio.run(send_weekend_reminders(app)), 'cron', day_of_week='sat,sun', hour=16, minute=0)
scheduler.add_job(lambda: asyncio.run(send_day_before_reminders(app)), 'cron', hour=10)
scheduler.start()

app.run_polling()
